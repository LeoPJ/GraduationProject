import pymysql
import time
import matplotlib.pyplot as plt
import numpy as np
import matplotlib.font_manager as mfm
import os
from itertools import chain

seq=[['pl', 1507093925, 2.270999999999999], ['sf', 1507093933, 54.75500000000001], ['pl', 1507093933, 24.284999999999997], ['sf', 1507093965, 1.039999999999992], ['pl', 1507093965, 108.76], ['pl', 1507094764, 39.559], ['sb', 1507094807, 11.879999999999995], ['pl', 1507094807, 2.3999999999999915], ['pl', 1507095440, 3.623], ['pl', 1508801382, 14.120000000000005], ['sf', 1508801400, 4.079999999999998], ['pl', 1508801400, 83.88000000000001], ['pa', 1508801484, 17], ['pl', 1508801501, 5.039999999999992], ['pl', 1508810674, 16.120000000000005], ['sf', 1508810704, 106.71999999999998], ['pl', 1508810704, 29.159999999999997], ['sb', 1508810897, 10.279999999999973], ['pl', 1508810897, 4.47999999999999], ['sb', 1508810907, 15.87299999999999], ['pl', 1508810907, 17.912999999999982], ['rf', 1508810926, 0], ['pl', 1508810926, 10.560000000000002], ['rs', 1508810939, 0], ['pl', 1508810939, 11.223000000000013], ['sb', 1508810964, 9.268], ['pl', 1508810964, 9.427999999999997], ['sb', 1508810984, 14.685000000000002], ['pl', 1508810984, 7.125], ['pa', 1508811002, 44], ['pl', 1508811046, 6.319999999999993], ['sb', 1508811080, 3.7939999999999827], ['pl', 1508811080, 3.033999999999992], ['sb', 1508811233, 6.47999999999999], ['pl', 1508811233, 8.560000000000002], ['sb', 1508811250, 2.8230000000000075], ['pl', 1508811250, 2.1030000000000086], ['sb', 1508811255, 3.281000000000006], ['pl', 1508811255, 3.320999999999998], ['pa', 1508811263, 21], ['pl', 1508811284, 3.920000000000016], ['sb', 1508811298, 11.499000000000024], ['pl', 1508811298, 7.179000000000002], ['sb', 1508811314, 12.706999999999994], ['pl', 1508811314, 14.90700000000001], ['sb', 1508811535, 10.88900000000001], ['pl', 1508811535, 7.609000000000009], ['rd', 1508811862, 0], ['pl', 1508811862, 13.13900000000001], ['sb', 1508811930, 7.253999999999991], ['pl', 1508811930, 23.813999999999993], ['sb', 1508812349, 22.423000000000002], ['pl', 1508812349, 13.863], ['pa', 1508812363, 22], ['pl', 1508812385, 6.0], ['sb', 1508812642, 131.88], ['pl', 1508812642, 27.64], ['sb', 1508812676, 14.119], ['pl', 1508812676, 12.599000000000004], ['sf', 1508812713, 100.017], ['pl', 1508812713, 2.2630000000000052], ['rs', 1508812796, 0], ['pl', 1508812796, 16.920000000000016], ['sb', 1508812887, 2.733000000000004], ['pl', 1508812887, 2.212999999999994], ['sb', 1508812900, 2.977000000000004], ['pl', 1508812900, 3.016999999999996], ['sb', 1508812931, 4.459000000000003], ['pl', 1508812931, 7.65900000000002], ['sb', 1508812956, 6.38900000000001], ['pl', 1508812956, 6.229000000000013], ['sb', 1508813042, 7.342000000000013], ['pl', 1508813042, 2.1820000000000164], ['pa', 1508813049, 16], ['pl', 1508813065, 2.0], ['pa', 1508813069, 10], ['pl', 1508813079, 2.480000000000018], ['sb', 1508813146, 5.968000000000018], ['pl', 1508813146, 6.288000000000011], ['sb', 1508813172, 3.7350000000000136], ['pl', 1508813172, 3.575000000000017], ['sb', 1508813222, 2.716000000000008], ['pl', 1508813222, 3.475999999999999], ['sb', 1508813243, 2.3649999999999807], ['pl', 1508813243, 3.204999999999984], ['sb', 1508813255, 7.969999999999999], ['pl', 1508813255, 8.01000000000002], ['pa', 1508813272, 13], ['pl', 1508813285, 2.164999999999992], ['sb', 1508813297, 7.360000000000014], ['pl', 1508813297, 6.240000000000009], ['sb', 1508813312, 1.0180000000000007], ['pl', 1508813312, 2.337999999999994], ['sb', 1508813323, 4.298000000000002], ['pl', 1508813323, 2.1780000000000257], ['sb', 1508813329, 4.7520000000000095], ['pl', 1508813329, 7.391999999999996], ['sb', 1508813344, 3.4490000000000123], ['pl', 1508813344, 2.569000000000017], ['sb', 1508813349, 7.655000000000001], ['pl', 1508813349, 17.215000000000003], ['rd', 1508813671, 0], ['pl', 1508813671, 30.360000000000014], ['sf', 1508813729, 1.4799999999999898], ['pl', 1508813729, 2.4000000000000057], ['pa', 1508813731, 26], ['pl', 1508813757, 6.159999999999997], ['sb', 1508813812, 108.84], ['pl', 1508813812, 2.0800000000000125], ['sb', 1508813817, 10.320000000000007], ['pl', 1508813817, 10.239999999999995], ['sf', 1508813831, 102.96000000000001], ['pl', 1508813831, 2.960000000000008], ['pl', 1508815142, 2.503], ['sf', 1508815147, 1.7599999999999998], ['pl', 1508815147, 2.88], ['sf', 1508815156, 204.857], ['pl', 1508815156, 6.502999999999986], ['pa', 1508815162, 2], ['pl', 1508815164, 6.240000000000009], ['sf', 1508815173, 1.240000000000009], ['pl', 1508815173, 10.599999999999994], ['pl', 1508819958, 18.183], ['sf', 1508819983, 184.8], ['pl', 1508819983, 22.919999999999987], ['sf', 1508820045, 1.0800000000000125], ['pl', 1508820045, 3.240000000000009], ['sf', 1508820093, 3.8799999999999955], ['pl', 1508820093, 2.280000000000001], ['pa', 1508820095, 30], ['pl', 1508820125, 5.280000000000001], ['sb', 1508820310, 28.640000000000015], ['pl', 1508820310, 10.56000000000003], ['pa', 1508820320, 40], ['pl', 1508820360, 9.199999999999989], ['sf', 1508820399, 1.1599999999999966], ['pl', 1508820399, 4.280000000000001], ['rs', 1508820897, 0], ['pl', 1508820897, 3.6610000000000014], ['sb', 1508820906, 11.52000000000001], ['pl', 1508820906, 11.640000000000015], ['pa', 1508820929, 37], ['pl', 1508820966, 3.4000000000000057], ['sf', 1508820985, 1.1599999999999966], ['pl', 1508820985, 2.1200000000000045], ['sb', 1508821095, 21.75999999999999], ['pl', 1508821095, 28.039999999999992], ['sb', 1508821239, 23.72], ['pl', 1508821239, 5.200000000000017], ['pa', 1508821250, 13], ['pl', 1508821263, 4.280000000000001], ['pa', 1508821271, 9], ['pl', 1508821280, 12.0], ['sf', 1508821320, 3.240000000000009], ['pl', 1508821320, 2.280000000000001], ['pa', 1508821325, 10], ['pl', 1508821335, 5.640000000000015], ['pa', 1508821346, 27], ['pl', 1508821373, 11.680000000000007], ['sb', 1508821471, 11.0], ['pl', 1508821471, 6.759999999999991], ['sb', 1508821546, 47.0], ['pl', 1508821546, 7.079999999999956], ['pa', 1508821561, 15], ['pl', 1508821576, 18.480000000000018], ['pa', 1508821612, 14], ['pl', 1508821626, 9.360000000000014], ['rd', 1508821780, 0], ['pl', 1508821780, 12.040000000000006], ['sf', 1508821797, 66.4], ['pl', 1508821797, 6.439999999999998], ['pa', 1508821803, 89], ['pl', 1508821892, 7.9199999999999875], ['pa', 1508821899, 12], ['pl', 1508821911, 5.719999999999999], ['sf', 1508821976, 1.1999999999999886], ['pl', 1508821976, 6.1200000000000045], ['pa', 1508821983, 12], ['pl', 1508821995, 4.159999999999997], ['sf', 1508822041, 1.8000000000000114], ['pl', 1508822041, 7.9199999999999875], ['sf', 1508822106, 1.4000000000000057], ['pl', 1508822106, 9.23999999999998], ['pl', 1508831942, 2.583], ['sf', 1508831954, 202.6], ['pl', 1508831954, 3.4000000000000057], ['pl', 1508851594, 7.1200000000000045], ['sb', 1508851602, 22.983000000000004], ['pl', 1508851602, 16.863], ['pl', 1508855761, 3.943], ['sf', 1508855773, 203.11999999999998], ['pl', 1508855773, 2.1200000000000045], ['pa', 1508855775, 25], ['pl', 1508855800, 2.719999999999999], ['pl', 1508904070, 3.0], ['sf', 1508904157, 67.44], ['pl', 1508904157, 9.480000000000018], ['sb', 1508904180, 29.706000000000017], ['pl', 1508904180, 29.106000000000023], ['sb', 1508904302, 5.572000000000003], ['pl', 1508904302, 5.651999999999987], ['sb', 1508904321, 4.126999999999981], ['pl', 1508904321, 6.806999999999988], ['sb', 1508904330, 10.430000000000007], ['pl', 1508904330, 8.349999999999994], ['sb', 1508904350, 1.813999999999993], ['pl', 1508904350, 3.6140000000000043], ['sb', 1508904360, 10.045000000000016], ['pl', 1508904360, 7.405000000000001], ['sb', 1508904373, 3.3179999999999836], ['pl', 1508904373, 3.877999999999986], ['pa', 1508904379, 96], ['pl', 1508904475, 14.621999999999986], ['sb', 1508904549, 21.74799999999999], ['pl', 1508904549, 23.50799999999998], ['sb', 1508904617, 7.329999999999984], ['pl', 1508904617, 5.530000000000001], ['sb', 1508904691, 25.068000000000012], ['pl', 1508904691, 10.108000000000004], ['sb', 1508904723, 11.489000000000004], ['pl', 1508904723, 51.16899999999998], ['pa', 1508904775, 23], ['pl', 1508904798, 11.95999999999998], ['sb', 1508904814, 45.91999999999999], ['pl', 1508904814, 17.200000000000017], ['sb', 1508904843, 19.560000000000002], ['pl', 1508904843, 11.0], ['pa', 1508904854, 15], ['pl', 1508904869, 11.199999999999989], ['sf', 1508904935, 1.0800000000000125], ['pl', 1508904935, 6.840000000000003], ['sf', 1508904944, 3.1999999999999886], ['pl', 1508904944, 2.5999999999999943], ['pa', 1508904947, 36], ['pl', 1508904983, 5.800000000000011], ['pa', 1508904989, 24], ['pl', 1508905013, 8.04000000000002], ['sb', 1508905092, 125.44000000000003], ['pl', 1508905092, 172.79999999999998], ['sb', 1508905265, 111.10300000000001], ['pl', 1508905265, 99.94300000000004], ['sb', 1508905391, 8.960000000000036], ['pl', 1508905391, 3.0400000000000205], ['pl', 1509419151, 17.223], ['sf', 1509419180, 177.07999999999998], ['pl', 1509419180, 14.280000000000001], ['sf', 1509419225, 10.039999999999992], ['pl', 1509419225, 6.8799999999999955], ['pa', 1509419232, 44], ['pl', 1509419276, 4.8799999999999955], ['pa', 1509419281, 12], ['pl', 1509419293, 4.320000000000022], ['sf', 1509419420, 2.4000000000000057], ['pl', 1509419420, 10.559999999999974], ['sf', 1509419566, 2.0800000000000125], ['pl', 1509419566, 15.400000000000006], ['sf', 1509419687, 2.240000000000009], ['pl', 1509419687, 13.839999999999975], ['sb', 1509419753, 127.56], ['pl', 1509419753, 54.32000000000002], ['pa', 1509419808, 67], ['pl', 1509419875, 16.960000000000008], ['sb', 1509420262, 22.319999999999993], ['pl', 1509420262, 2.6399999999999864], ['sf', 1509420379, 1.9199999999999875], ['pl', 1509420379, 14.480000000000018], ['sf', 1509420441, 8.799999999999983], ['pl', 1509420441, 5.600000000000023], ['sb', 1509420555, 38.80000000000001], ['pl', 1509420555, 33.08000000000001], ['pa', 1509420588, 57], ['pl', 1509420645, 4.240000000000009], ['sf', 1509420755, 1.0], ['pl', 1509420755, 4.8799999999999955], ['sf', 1509420763, 2.5999999999999943], ['pl', 1509420763, 5.840000000000003], ['pa', 1509420769, 60], ['pl', 1509420829, 3.799999999999983], ['pl', 1511095974, 12.863000000000028], ['rf', 1511095988, 0], ['pl', 1511095988, 122.15999999999994], ['sf', 1511096050, 2.0], ['pl', 1511096050, 3.5600000000000023], ['rd', 1511096052, 0], ['pl', 1511096052, 2.319999999999993], ['pl', 1511097690, 3.16], ['sf', 1511097699, 186.17], ['pl', 1511097699, 18.03], ['pa', 1511097718, 435], ['pl', 1511098153, 15.759999999999991], ['pa', 1511098168, 304], ['pl', 1511098472, 12.0], ['pl', 1511131643, 51.223], ['sf', 1511131696, 121.777], ['pl', 1511131696, 3.5829999999999984], ['sf', 1511131703, 15.939999999999998], ['pl', 1511131703, 54.140000000000015], ['sb', 1511131761, 131.663], ['pl', 1511131761, 2.462999999999994], ['sb', 1511131769, 30.462999999999994], ['pl', 1511131769, 98.143], ['sb', 1511131871, 99.176], ['pl', 1511131871, 49.896], ['sb', 1511131925, 41.727999999999994], ['pl', 1511131925, 45.487999999999985], ['sb', 1511131973, 40.609999999999985], ['pl', 1511131973, 32.129999999999995], ['sb', 1511132007, 63.741], ['pl', 1511132007, 51.781000000000006], ['sb', 1511132171, 25.39], ['pl', 1511132171, 48.22999999999999], ['sb', 1511132220, 35.937], ['pl', 1511132220, 4.257000000000005], ['sb', 1511132225, 25.019000000000005], ['pl', 1511132225, 26.058999999999997], ['sb', 1511132242, 38.840999999999994], ['pl', 1511132242, 64.64099999999999], ['sb', 1511132310, 20.413999999999987], ['pl', 1511132310, 22.01399999999998], ['sb', 1511132336, 40.48599999999999], ['pl', 1511132336, 16.126000000000005], ['sb', 1511132674, 3.6680000000000064], ['pl', 1511132674, 31.867999999999995], ['sb', 1511132708, 46.45899999999999], ['pl', 1511132708, 37.57899999999999], ['sb', 1511132946, 12.536999999999992], ['pl', 1511132946, 2.057000000000002], ['sb', 1511132950, 35.873000000000005], ['pl', 1511132950, 31.432999999999993], ['sb', 1511132991, 5.941999999999993], ['pl', 1511132991, 7.901999999999987], ['sb', 1511132995, 4.474999999999994], ['pl', 1511132995, 2.355000000000004], ['sb', 1511132999, 5.259], ['pl', 1511132999, 4.0589999999999975], ['sf', 1511133031, 1.4000000000000057], ['pl', 1511133031, 5.079999999999998], ['sb', 1511133036, 19.153000000000006], ['pl', 1511133036, 34.873000000000005], ['pl', 1511153495, 96.783], ['sb', 1511153600, 12.280000000000001], ['pl', 1511153600, 9.480000000000004], ['sf', 1511153762, 132.017], ['pl', 1511153762, 2.1829999999999927], ['sb', 1511153768, 24.400000000000006], ['pl', 1511153768, 2.0800000000000125], ['pl', 1511154513, 16.72], ['pl', 1511155437, 9.039999999999992], ['pl', 1511171976, 17.560000000000002], ['sf', 1511171997, 3.2799999999999727], ['pl', 1511171997, 7.920000000000016], ['pl', 1511173056, 29.543000000000006], ['sb', 1511173098, 7.680000000000007], ['pl', 1511173098, 5.8799999999999955], ['pl', 1511187506, 5.6229999999999905], ['pa', 1511187511, 4], ['pl', 1511187515, 5.800000000000011], ['pa', 1511187521, 52], ['pl', 1511187573, 10.799999999999983], ['sb', 1511187630, 50.84], ['pl', 1511187630, 49.28], ['sf', 1511187697, 1.4799999999999898], ['pl', 1511187697, 15.719999999999999], ['pa', 1511187713, 32], ['pl', 1511187745, 16.639999999999986], ['pa', 1511187762, 32], ['pl', 1511187794, 12.160000000000025], ['sb', 1511187821, 47.59300000000002], ['pl', 1511187821, 46.19300000000004], ['pl', 1511190137, 4.640000000000015], ['sf', 1511190150, 1.1599999999999966], ['pl', 1511190150, 9.759999999999991], ['pl', 1511217179, 41.22300000000001], ['pl', 1511271122, 114.263]]
for r in seq:
	print(r)
pl=[]
pa=[]
sf=[]
sb=[]
for row in seq:
	if row[0]=='pl':
		pl.append(row[2])
	elif row[0]=='pa':
		pa.append(row[2])
	elif row[0]=='sf':
		sf.append(row[2])
	elif row[0]=='sb':
		sb.append(row[2])

pl_Q1=np.quantile(pl,0.25,interpolation='lower')#下四分位数
pl_Q2=np.median(pl) #中位数
pl_Q3=np.quantile(pl,0.75,interpolation='higher')#上四分位数
pa_Q1=np.quantile(pa,0.25,interpolation='lower')#下四分位数
pa_Q2=np.median(pa) #中位数
pa_Q3=np.quantile(pa,0.75,interpolation='higher')#上四分位数
sf_Q1=np.quantile(sf,0.25,interpolation='lower')#下四分位数
sf_Q2=np.median(sf) #中位数
sf_Q3=np.quantile(sf,0.75,interpolation='higher')#上四分位数
sb_Q1=np.quantile(sb,0.25,interpolation='lower')#下四分位数
sb_Q2=np.median(sb) #中位数
sb_Q3=np.quantile(sb,0.75,interpolation='higher')#上四分位数
print(pl_Q1,pl_Q2,pl_Q3,pa_Q1,pa_Q2,pa_Q3,sf_Q1,sf_Q2,sf_Q3,sb_Q1,sb_Q2,sb_Q3)


avseq=[]
for row in seq:
	if row[0]=='pa':
		if row[2]<=pa_Q1:
			avseq.append('pa1')
		elif row[2]>pa_Q1 and row[2]<=pa_Q2:
			avseq.append('pa2')
		elif row[2]>pa_Q2 and row[2]<=pa_Q3:
			avseq.append('pa3')
		else:
			avseq.append('pa4')

	elif row[0]=='sf':
		if row[2]<=sf_Q1:
			avseq.append('sf1')
		elif row[2]>sf_Q1 and row[2]<=sf_Q2:
			avseq.append('sf2')
		elif row[2]>sf_Q2 and row[2]<=sf_Q3:
			avseq.append('sf3')
		else:
			avseq.append('sf4')

	elif row[0]=='sb':
		if row[2]<=sb_Q1:
			avseq.append('sb1')
		elif row[2]>sb_Q1 and row[2]<=sb_Q2:
			avseq.append('sb2')
		elif row[2]>sb_Q2 and row[2]<=sb_Q3:
			avseq.append('sb3')
		else:
			avseq.append('sb4')

	elif row[0]=='rf':
		avseq.append('rf')

	elif row[0]=='rs':
		avseq.append('rs')
		
	elif row[0]=='rd':
		avseq.append('rd')
	
	elif row[0]=='pl':
		if row[2]<=pl_Q1:
			avseq.append('pa1')
		elif row[2]>pl_Q1 and row[2]<=pl_Q2:
			avseq.append('pa2')
		elif row[2]>pl_Q2 and row[2]<=pl_Q3:
			avseq.append('pa3')
		else:
			avseq.append('pa4')

print(avseq)
print(len(avseq))

